<div class="container-fluid main-section">
  <div class="modal-content">
    <!-- Filtros de Búsqueda -->
    <form [formGroup]="formFiltro">
      <!-- <h1 id="tituloTabla">Usuarios <i class="fa-solid fa-users"></i></h1> -->
      <div class="container">
        <h4 class="title-menu centered-rounded-background">
            <a>
                <img *ngIf="imgSubmenu !== undefined" class="img-crud" src="{{imgSubmenu.TipoIcono}}{{imgSubmenu.Icono}}" />
            </a>
            <a style="margin-left: 5px;">Usuario</a>
        </h4>
      </div>
      <div class="row mt-3">
        <div class="col-md-3">
          <label for="idFiltro">Filtrar Por:</label>
          <select formControlName="idFiltro" class="form-control" id="idFiltro" (change)="cambiarFiltro()">
            <option value="1">Solo Habilitados</option>
            <option value="2">Solo Inhabilitados</option>
          </select>
        </div>
        <div class="col-md-4">
          <label for="equipo">Personal:</label>
          <div class="input-group">
            <input type="text" formControlName="equipo" class="form-control" id="equipo" placeholder="Equipo">
            <div class="input-group-append">
              <button class="btn btn-outline-secondary" type="button">Buscar</button>
              <button class="btn btn-outline-secondary" type="button">Limpiar</button>
            </div>
          </div>
        </div>

        <div class="col-md-5 d-flex justify-content-end"> <!-- Utiliza d-flex y justify-content-end -->
          <button type="button" class="btn btn-primary" id="AgregarModalbtn" (click)="openAgregar(content)">
            <i class="fa-solid fa-user-plus button-icon"></i>Crear
          </button>
        </div>
      </div>
    </form>
    <div class="registros mt-3" *ngIf="listaGrilla && listaGrilla.length > 0; else noData">
      <div class="table-responsive">
        <div class="scroll-table">
          <table class="table">
            <thead class="thead-dark">
              <tr>
                <th scope="col"></th> <!-- Ver -->
                <th scope="col">Nro</th>
                <th scope="col">Usuario</th>
                <th scope="col">Nombre</th>
                <th scope="col">Apellido</th>
                <th scope="col">Documentacion</th>
                <th scope="col">Fecha de Alta</th>
                <th scope="col">Estado</th>
                <th scope="col">Acción</th> <!-- Corregido: "Accion" a "Acción" -->
              </tr>
            </thead>
            <tbody class="tablaUser" *ngFor="let item of listaGrilla; let i = index">
              <tr>
                <td scope="col"></td> <!-- Ver -->
                <td scope="col">{{ item.IdUsuario }}</td>
                <td scope="col">{{ item.Usuario}}</td>
                <td scope="col">{{ item.Nombre}}</td>
                <td scope="col">{{ item.Apellido}}</td>
                <td scope="col">{{ item.Documentacion}}</td>
                <td scope="col">{{ item.FechaAlta }}</td>
                <td scope="col">{{ item.FechaBaja === null ? 'Activo' : 'No Activo' }}</td>
                <td scope="col" class="dropdown">
                    <!-- Botón de acción con menú desplegable -->
                      <button class="btn btn-secondary dropdown-toggle" type="button" id="dropdownMenuButton" data-bs-toggle="dropdown" aria-expanded="false">
                        <i class="fa-solid fa-user-gear"></i>
                      </button>
                      <!-- Menú desplegable con opciones -->
                  <ul class="dropdown-menu" aria-labelledby="dropdownMenuButton">
                    <li *ngIf="item.FechaBaja === null">
                      <a class="dropdown-item" (click)="openEditar(content, item)">
                        <i class="fas fa-edit"></i> Editar
                      </a>
                    </li>
                    <li *ngIf="item.FechaBaja === null">
                      <a class="dropdown-item" (click)="openEditarSucursal(content, item)">
                        <i class="fas fa-landmark"></i> Sucursal
                      </a>
                    </li>
                    <li *ngIf="item.FechaBaja === null">
                      <a class="dropdown-item" (click)="openEditarRol(content, item)">
                        <i class="fas fa-chalkboard-teacher"></i> Rol
                      </a>
                    </li>
                    <li *ngIf="item.FechaBaja === null">
                      <a class="dropdown-item" (click)="openInhabilitar(contentInhabilitar, item)">
                        <i class="fa-solid fa-xmark"></i> Inhabilitar
                      </a>
                    </li>
                  </ul>
                </td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>
    </div>
    <ng-template #noData>
      <h5>No se encontraron registros...</h5>
    </ng-template>
  </div>
</div>
<!-- AgregarUsuarioModal -->
<ng-template #content let-modal>
  <div class="modal-header">
    <a></a><h4 class="modal-title">{{ tituloModal }}</h4>
  </div>
  <div class="modal-body">
    <form [formGroup]="formItemGrilla">
      <div class="form-row">
        <div *ngIf="tituloModal == 'Agregar'" class="form-group col-md-10">
          <div style="margin-bottom: 15px">
            <label for="Usuario">Usuario</label>
          </div>
          <input [(ngModel)]="itemGrilla.Usuario" type="text" formControlName="usuario" class="form-control" id="usuario" placeholder="Ingrese un Usuario">
        </div>
        <div *ngIf="tituloModal == 'Agregar'" class="form-group col-md-10">
          <div style="margin-bottom: 15px ; margin-top: 15px">
            <label for="Clave">Clave</label>
          </div>
          <input [(ngModel)]="itemGrilla.Clave" type="text" formControlName="clave" class="form-control" id="clave" placeholder="Ingrese una Clave">
        </div>
        <div *ngIf="tituloModal == 'Agregar'" class="form-group col-md-10">
          <label for="recipient-name" class="col-form-label">Personal</label>
          <select formControlName="listaPersonal" class="form-control" id="listaPersonal">
            <option value="" disabled>Seleccione...</option>
            <option *ngFor="let persona of lPersonas" [value]="persona.IdPersona">{{ persona.NombrePersona }}</option>
          </select>
        </div>
        <div *ngIf="tituloModal == 'Editar Sucursal'" class="form-group col-md-10">
          <label for="sucursal" class="col-form-label">Sucursal</label>
          <select formControlName="sucursal" class="form-control" id="sucursal">
            <option value="" disabled>Seleccione...</option>
            <option *ngFor="let sucursal of lSucursales" [value]="sucursal.IdSucursal">{{ sucursal.Descripcion }}</option>
          </select>
        </div>
        <div *ngIf="tituloModal == 'Editar Rol'" class="form-group col-md-10">
          <label for="rol" class="col-form-label">Roles</label>
          <select formControlName="rol" class="form-control" id="rol">
            <option value="" disabled>Seleccione...</option>
            <option *ngFor="let rol of lRoles" [value]="rol.IdTipoRol">{{ rol.Descripcion }}</option>
          </select>
        </div>
      </div>
      <div class="form-group col text-right" style="margin-top: 25px;">
        <button type="button" class="btn btn-danger me-2" (click)="modal.dismiss()">Cancelar</button>
        <button type="button" class="btn btn-success" (click)="guardar()">{{ tituloBoton }}</button>
      </div>
    </form>
  </div>
</ng-template>

<ng-template #contentInhabilitar let-modal>
  <div class="modal-header">
    <a></a><h4 class="modal-title">{{ tituloModal }}</h4>
  </div>
  <div class="modal-body">
      <a></a><h4 class="">Desea Eliminar?</h4>
    <div class="modal-footer">
      <button type="button" class="btn btn-danger me-2" (click)="modal.dismiss()">Cancelar</button>
      <button type="button" class="btn btn-primary" (click)="inhabilitar()">Aceptar</button>
        </div>
  </div>
</ng-template>

<div class="modal fade" id="modificarUsuarioModal" tabindex="-1" aria-labelledby="modificarUsuarioModalLabel" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h1 class="modal-title fs-5" id="modificarUsuarioModalLabel"><i class="fa-solid fa-user-pen"></i>Modificar Usuario</h1>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body">
        <form>
          <div class="mb-3">
            <label for="recipient-name" class="col-form-label">Personal</label>
            <select formControlName="listaPersonal" class="form-control" id="listaPersonal">
                <option value="" disabled selected hidden>Seleccione...</option>
                <option value="opcion1">Opción 1</option>
                <option value="opcion2">Opción 2</option>
                <option value="opcion3">Opción 3</option>
            </select>
          </div>
          <div class="mb-3">
            <label for="message-text" class="col-form-label">Usuario</label>
            <input type="text" id="Usuario" class="form-control">
          </div>
        </form>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-danger" data-bs-dismiss="modal">Cancelar</button>
        <button type="button" class="btn btn-primary">Guardar</button>
      </div>
    </div>
  </div>
</div>
<div class="modal fade" id="gestionarContrasenaModal" tabindex="-1" aria-labelledby="gestionarContrasenaModalLabel" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h1 class="modal-title fs-5" id="gestionarContrasenaModalLabel"><i class="fa-solid fa-key"></i>Gestionar Contraseña</h1>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body">
        <form>
          <div class="mb-3">
            <label for="message-text" class="col-form-label">Usuario</label>
            <input type="text" id="Usuario" class="form-control">
          </div>
          <div class="mb-3">
            <label for="message-text" class="col-form-label">Contraseña</label>
            <input type="text" id="Clave" class="form-control">
          </div>
          <div class="mb-3">
            <label for="message-text" class="col-form-label">Por favor repita la contraseña</label>
            <input type="text" id="ClaveRepetida" class="form-control">
          </div>
        </form>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-danger" data-bs-dismiss="modal">Cancelar</button>
        <button type="button" class="btn btn-primary">Guardar</button>
      </div>
    </div>
  </div>
</div>
<div class="modal fade" id="asignarRolModal" tabindex="-1" aria-labelledby="asignarRolModalLabel" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h1 class="modal-title fs-5" id="asignarRolModalLabel"><i class="fa-solid fa-id-badge"></i>Asignar Rol/Roles</h1>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body">
        <form>
          <div class="mb-3">
            <label for="message-text" class="col-form-label">Usuario</label>
            <input type="text" id="Usuario" class="form-control">
          </div>
          <div class="mb-3">
            <label for="recipient-name" class="col-form-label">Seleccione el Rol</label>
            <select formControlName="listaRoles" class="form-control" id="listaRoles">
              <option value="" disabled selected hidden>Seleccione...</option>
              <option value="opcion1">Opción 1</option>
              <option value="opcion2">Opción 2</option>
              <option value="opcion3">Opción 3</option>
            </select>
          </div>
          <div class="text-end"> <!-- Estilo para alinear a la derecha -->
            <button type="button" class="btn btn-primary" id="asignarBtn">Asignar</button>
          </div>
        </form>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-danger" data-bs-dismiss="modal">Cancelar</button>
      </div>
    </div>
  </div>
</div>

<div class="modal fade" id="asignarSucursalModal" tabindex="-1" aria-labelledby="asignarSucursalModalLabel" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h1 class="modal-title fs-5" id="asignarSucursalModalLabel">Asignar Sucursal</h1>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body">
        <form>
          <div class="mb-3">
            <label for="recipient-name" class="col-form-label">Sucursal</label>
            <select formControlName="listaPersonal" class="form-control" id="listaPersonal">
                <option value="" disabled selected hidden>Seleccione la Sucursal</option>
                <option value="opcion1">Opción 1</option>
                <option value="opcion2">Opción 2</option>
                <option value="opcion3">Opción 3</option>
            </select>
          </div>
        </form>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-danger" data-bs-dismiss="modal">Cancelar</button>
        <button type="button" class="btn btn-primary">Guardar</button>
      </div>
    </div>
  </div>
</div>
<div class="modal fade" id="inhabilitarModal" tabindex="-1" aria-labelledby="inhabilitarModalLabel" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h1 class="modal-title fs-5" id="inhabilitarModalLabel"><i class="fa-solid fa-user-xmark"></i>Inhabilitar Usuario</h1>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body">
        <form>
          <div class="mb-3">
            <label for="message-text" class="col-form-label">Usuario</label>
            <input type="text" id="Usuario" class="form-control">
          </div>
          <div class="mb-3">
            <label for="message-text" class="col-form-label">Motivo</label>
            <input type="text" id="motivo" class="form-control">
          </div>
        </form>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-danger" data-bs-dismiss="modal">Eliminar</button>
        <button type="button" class="btn btn-primary">Guardar</button>
      </div>
    </div>
  </div>
</div>
<footer class="footer">
  <app-footer></app-footer>
</footer>
